https://gallery.technet.microsoft.com/Get-Windows-Product-6b5e6f6e

Windows License Extractor is a small PowerShell/WinForms GUI tool (Sapien PowerShell Studio 2015) that will help you to display/export licensing information (including the product key where possible) for your current running operating system, as well as remote computer systems.

It can be run against a multiple remote machines in bulk and export the collected data into CSV file:

This utility can be useful if you lost the product key of your Windows, and you want to reinstall it on your computer.
Note that if the Windows product key is not stored in the Registry (like in volume licenses) it will be displayed partially.

Verified on the following platforms
Windows 10	Yes
Windows Server 2012	Yes
Windows Server 2012 R2	No
Windows Server 2008 R2	Yes
Windows Server 2008	Yes
Windows Server 2003	No
Windows Server 2016	No
Windows 8	Yes
Windows 7	Yes
Windows Vista	No
Windows XP	No
Windows 2000	No
